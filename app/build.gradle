buildscript {
  repositories {
    mavenCentral()
  }
  dependencies {
    classpath 'com.stanfy.spoon:spoon-gradle-plugin:1.2.2'
  }
}

apply plugin: 'com.android.application'
apply plugin: 'spoon'

android {
  compileSdkVersion 24
  buildToolsVersion "24.0.3"
  defaultConfig {
    applicationId "com.mamewo.podplayer0"
    minSdkVersion 10
    targetSdkVersion 19
    versionCode 14
    versionName "1.1.2"

    //For espresso
    //testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
  }

  signingConfigs {
    release {
      if(System.getenv("KEYSTORE") != null){
        storeFile file(System.getenv("KEYSTORE"))
        storePassword System.getenv("KEYSTORE_PASSWORD")
        keyAlias System.getenv("KEY_ALIAS")
        keyPassword System.getenv("KEY_PASSWORD")
      }
      else {
        storeFile null
        storePassword ""
        keyAlias ""
        keyPassword ""
      }
    }
  }
  
  buildTypes {
    release {
      minifyEnabled false
      //proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
      signingConfig signingConfigs.release
    }
  }
  
  lintOptions {
    abortOnError false
  }
}

spoon {
  //For espresso
  // configurations.all {
  //   resolutionStrategy.force 'com.android.support:support-annotations:23.1.1'
  // }

  //instrumentationArgs = ["package=com.mamewo.podplayer0.tests"]
  if(project.hasProperty('spoonClassName')){
    className = project.spoonClassName
  }
  else {
    className = 'com.mamewo.podplayer0.tests.TestPodplayerActivity'
  }
  if(project.hasProperty('spoonMethodName')){
    methodName = project.spoonMethodName
  }
  if(project.hasProperty('spoonOutput')){
    baseOutputDir = file("$buildDir/"+project.spoonOutput)
  }
  debug = true
  
  // className = 'com.mamewo.podplayer0.tests.TestPodplayerActivity'
  //methodName = 'testAddPodcast'
  //from 1.5.0?
  //codeCoverage = true
}

dependencies {
  compile project(":podcast_parser")
  compile project(":pulltorefresh")
  compile 'com.android.support:support-v4:24.0.0'
  compile 'com.android.support:appcompat-v7:24.0.0'
  compile 'com.android.support:preference-v7:24.0.0'
  compile 'com.android.support:cardview-v7:24.0.0'
  compile 'com.android.support:recyclerview-v7:24.0.0'
  
  compile 'com.github.bumptech.glide:glide:3.7.0'
  
  androidTestCompile 'com.jayway.android.robotium:robotium-solo:5.6.3'
  androidTestCompile 'com.squareup.spoon:spoon-client:1.6.4'
  androidTestCompile 'com.jraska:falcon-spoon-compat:1.0.3'

  //androidTestCompile 'com.android.support.test.espresso:espresso-core:2.2.2'
  //androidTestCompile 'com.android.support:support-annotations:23.1.1'
  //androidTestCompile 'com.android.support.test:runner:0.5'
}
